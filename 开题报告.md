# 开题报告
基于共享单车骑行数据的上海市通勤模式分析

## 一、	本课题的研究目的和意义
城市通勤数据反映了城市空间内中小尺度、周期性、密集型、高强度的人员流动情况。人们骑行共享单车属于一种缓慢的匀速移动，且具有较高的灵活性，其轨迹往往能够渗透到城市的每一条毛细血管般狭窄的道路中，相较于固定线路的通勤方式更能反映人的行为特性。结合以上两点，借助共享单车通勤轨迹数据，我们既可以从宏观上把握城市主要交通干线、主要产业热点区域一周七个工作日的人口规律性流动情况，分析总体城市职住分布与产业布局情况；我们也可以从城市的微观结构着手，探究渗入城市细小角落的骑行轨迹究竟反映了怎样的行为与细碎环境的相互作用。

无桩电子围栏式共享单车是一种具有浓厚互联网气息的产品服务，也是共享经济快速发展阶段的标志性产物。共享单车一般依赖 GPS 定位设备与互联网接入，借助电子围栏算法及主动式 GPS 定位圈定借还车区域及使用范围，并结合移动客户端与后台调度算法规范用户骑行行为（如骑行红包奖励及出圈扣除押金惩罚等）以达到维持正常经营的目的。相较于传统的有桩式公共自行车，共享单车具有极大地便利性性优势与极低的准入门槛，因此一经投放市场，共享单车的用户规模便快速扩大，其本身也成为解决城市通勤“最后一公里”、缓解城市污染与交通拥堵等问题的重要解决方案。然而，基于共享单车骑行轨迹的人员与物质流动模型其实是一种耗散模型，与任何自然发生的能量耗散一样，共享单车网络对于城市通勤的贡献也始终随着一天中时间的推移自然下降到低水平，也就意味着原本相对集中的易于使用的共享单车分布会由于通勤等原因变得难以使用。想要维持共享单车的合理分布物质流动循环畅通，就需要依赖通勤模式的指导下的强制调度，这种调度一般发生在非通勤时间，共享单车服务公司使用卡车或平板三轮车搜集散乱在城市各处的共享单车并整齐放置到合理的地点以支撑第二天的骑行通勤需求。因此，由共享单车骑行轨迹数据中挖掘出的通勤模式具有一定的指导意义。

综上所述，本研究旨在深入理解共享单车在城市通勤中的作用和局限性，为城市规划和交通管理提供科学参考，同时为共享单车服务的优化提供实践指导。
## 二、	本课题的主要研究内容（提纲）
1. 数据搜集与数据预处理
   1. 共享单车轨迹数据清洗：异常值剔除（范围异常、骑行时间异常、骑行速度异常）、重排序（按照骑行日期重新排序）、以天为单位切分为独立文件、某一天的独立文件再以 24 小时制排序。
   2. 共享单车轨迹数据预处理：根据公式计算轨迹点 GeoHash 值作为新的属性保存在文件中、删除原先的用户及车辆ID属性以时间顺序重新编码记录索引号。
   3. 乱序共享单车单车轨迹的重建与简化：根据 GeoHash 值重建骑行轨迹。
2. 基于共享单车轨迹的时空通勤模式分析
   1. 统计用户通勤距离、骑行时间等参数随时间的变化规律。
   2. 根据用户骑行数据绘制热力图，提取骑行热点区域，分析原因。
   3. 使用 TraClus 算法提取用户骑行的公共轨迹。
   4. 结合路网数据与骑行公共轨迹分析上海市道路建设对居民骑行通勤模式的影响。
3. 结论分析与制图
   1. 结合上述分析步骤的结果，使用相关软件制作统计图表、热力图、频次空间分布图等图表用于辅助分析与表达。
   2. 研究居民骑行通勤模式、结合上海市路网数据提出合理的道路建设优化建议。
## 三、	文献综述（国内外研究情况及其发展）
如何使用机器学习的方法来进行轨迹排序？
## 四、	拟解决的关键问题
1. 骑行轨迹复原与简化：由于与服务器的通讯存在延迟等原因，原数据集记录的轨迹中存在个别乱序点，这导致整体轨迹无法直接使用。并且，匀速骑行的轨迹中含有大量值得剔除的冗余点，比如，某段沿平直道路前进的轨迹只需保存起点和终点，而中间点均可视为冗余点。
2. 基于轨迹数据的聚类分析与公共轨迹提取：一般研究会将骑行轨迹视作离散点云，再使用基于密度的聚类方法进行分析。这样做往往会忽略轨迹本身作为二维矢量数据的结构特征，并且，提取出的热点区域只是一个模糊的空间范围，对于后续空间分析的支撑作用有限。
3. K 均值聚类并求解每一类的大致范围：一般的 K 均值聚类只会得到 n 个点集，研究者对每一个点集采用不同的样式以区分不同的类别，然而点集数据难以进行有效的空间分析，如果能够得到面数据则可以支持更加复杂精确的分析。拟采用凸包算法对聚类出的点集求解边界，再将边界视作每一类别的大致区域。
## 五、	研究思路和方法
1. 研究思路：轨迹模式的时空分析
   1. 时间变化分析：数据集中记录了2016年8月及2020年8月这两个整月的上海市某品牌共享单车骑行数据，最起码可从年际、月度、逐小时这几个尺度来分析时间上的用户骑行数据变化。
   2. 空间分布分析：同时对数据集使用基于密度聚类和公共轨迹提取，并结合上海市路网矢量数据进行空间分布的分析。重点考察，热点区域与公共轨迹是否重合，公共路径与哪些路段存在交点（经过了）等，为后续研究结论提供支撑。
2. 研究方法：
   1. 骑行轨迹复原与简化：轨迹复原与简化可以合并到一个步骤中实现。首先，使用 GeoHash 算法对每一个轨迹点建立空间索引并将改索引作为集合的健值（Key），利用 GeoHash 编码长度对应了空间索引定位的精度也就是所表示地理范围的大小对轨迹点进行去重合并，譬如在某一精度参数下（例如六比特位），某两个点的 GeoHash 计算值相同，则根据集合自动去重的特性同一 GeoHash 编码所代表的地理范围内只会保留一个有效轨迹点，这样也就同时实现了轨迹点去重与轨迹简化。执行完以上步骤后，再逐步使用最邻近点算法由起点开始复原骑行轨迹。
   2. 轨迹长度计算：采用半正弦公式算法来计算轨迹子段长度，再累加得到总弧段长度。
   3. 基于轨迹数据的聚类分析与公共轨迹提取：使用 TraClus 算法概括大量骑行轨迹的公共路径，寻找骑行公共路径。与传统的基于密度的空间统计方法不同，TraClus 算法是针对轨迹段进行空间聚类的算法，该算法首先将轨迹根据特征点切分为众多小段，然后再对这些小段进行相似度度量，最终归纳出众多轨迹的公共路径。提取出的公共路径可以与上海市路网数据进行求交，可以借此来研究骑行热点路段。
   4. 基于骑行始末点云的 K 均值聚类：结合上海市 POI 数据可以为每一段骑行轨迹的始末点打上标签，每一类标签赋值不同。然后根据 K 均值聚类得到上海市共享单车出行类型空间分布图。还可可以再对聚类结果求解凸包，得到各类型的大致范围，与上海市路网求取交集进一步指出每种类型的热点骑行路段，为城市规划出谋划策。
   5. 统计方法：依据时间顺序分别统计用户骑行时间、骑行距离及骑行频次，研究出共享单车通勤模式随时间变化的情况，绘制相关图表，得出结论。
## 六、	本课题的进度安排
第一阶段（2024.1.12 - 2024.3.15）: 确定研究方向，阅读国内外相关文献，总结论文思路、技术要点及待解决的实际问题。获取相关数据，研所可能会用到的技术框架，熟悉数据处理流程。
第二阶段（2024.3.16 - 2024.4.20）: 筛选、清洗、整合数据，数据处理算法实现与验证。
第三阶段（2024.4.21 - 2024.5.19）: 撰写论文初稿，提交初审，根据建议修改完善论文。
第四阶段（2024.5.20 - 2024.6.19）: 论文答辩，交流讨论。

## 参考文献
[1]李文翔,唐桂孔,刘博,等.基于摩拜骑行数据的上海市共享单车减排效益时空分析[J].环境科学学报,2021,41(11):4752-4759.DOI:10.13671/j.hjkxxb.2021.0213.
[2]王若萱,吴建平,奇格奇. 基于上海市数据的共享单车用户通勤模式研究（英文）[C]中国仿真学会.第三十三届中国仿真大会论文集.2021:16.DOI:10.26914/c.cnkihy.2021.025005.
[3]全雨霏. 南京市共享单车使用的时空特征及其骑行环境评估[D].东南大学,2024.DOI:10.27014/d.cnki.gdnau.2022.001097.
[4]常新. 基于共享单车轨迹数据的城市街道可骑行性研究[D].哈尔滨工业大学,2021.DOI:10.27061/d.cnki.ghgdu.2020.002483.
[5]Jie Bao, Tianfu He, Sijie Ruan , Yanhua Li, and Yu Zheng. 2017. Planning Bike Lanes based on Sharing-Bikes’ Trajectories[c]. In Proceedings of KDD’17, August 13–17, 2017, Halifax, NS, Canada., , 11 pages.
[6]刘泉宏,唐福星.基于K-means聚类算法与重心法的故障共享单车回收中心选址优化[J].运筹与管理,2023,32(07):85-91.
[7]谢光明. 基于改进时空图神经网络的共享单车流量预测[D].华东师范大学,2023.DOI:10.27149/d.cnki.ghdsu.2023.004430.
[8]刘冰,王舸洋,朱俊宇,等.基于共享单车大数据的骑行生活圈识别及其活动网络模式分析[J].城市规划学刊,2023(04):32-40.DOI:10.16361/j.upf.202304005.
[9]王俊,于爱荣.基于ConvLSTM的南京地区共享单车需求预测研究[J].软件工程,2024,27(02):55-59.DOI:10.19644/j.cnki.issn2096-1472.2024.002.011.
[10]谢国微. 天气及建成环境对共享单车出行需求的影响研究[D].南京林业大学,2024.DOI:10.27242/d.cnki.gnjlu.2022.000493.
[11]任丹. 基于TRACLUS算法的船舶轨迹分析系统的设计与实现[D].辽宁师范大学,2021.DOI:10.27212/d.cnki.glnsu.2020.001211.
