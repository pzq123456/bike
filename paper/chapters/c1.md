# 第一章 绪论
## 1.1 研究背景与意义
（背景）
摩拜单车于2016年4月首次在上海投入运营，并掀起了一轮以共享单车市场迅速膨胀为代表的共享经济热潮。33个大中小城市积极引进共享单车服务，当年全国累计投放共享单车约200万辆，日活跃车辆最高时达到了惊人的55万辆。此时小时单价稳定在一元，共享单车也逐步以“廉价、便捷、绿色”的美好形象打入城市通勤市场，快速扩张。在初步站稳脚跟，共享单车企业们于2019年掀起一轮涨价风波，小蓝单车、青桔单车、摩拜单车、哈啰单车等一众企业均上调起步价与每小时单价，有些企业涨幅超过三倍。当年年底，共享单车小时单价正式步入”三元时代“。

无桩电子围栏式共享单车是一种具有浓厚互联网气息的产品服务，也是共享经济快速发展阶段的标志性产物。共享单车一般依赖 GPS 定位设备与互联网接入，借助电子围栏算法及主动式 GPS 定位圈定借还车区域及使用范围，并结合移动客户端与后台调度算法规范用户骑行行为（如骑行红包奖励及出圈扣除押金惩罚等）以达到维持正常经营的目的。相较于传统的有桩式公共自行车，共享单车具有极大地便利性性优势与极低的准入门槛，因此一经投放市场，共享单车的用户规模便快速扩大，其本身也成为解决城市通勤“最后一公里”、缓解城市污染与交通拥堵等问题的重要解决方案。 

交通运输部部长李小鹏评认为共享单车是城市慢行系统的一种模式创新，是使用互联网思维解决交通运输问题的一种可行方式，尤其对解决人民群众出行的”最后一公里“问题十分有效。在一些城市，共享单车确实有效缓解了中短途、慢速交通系统的压力，打通了固定的交通基础设施与居民个性化目的地之间的“最后一公里”。共享单车的出现对城市发展，居民通勤行为塑造都带来深远的影响。

（意义）
然而，共享单车系统中的物质流动模型其实是一种耗散模型，与任何自然发生的能量耗散一样，共享单车网络对于城市通勤的贡献也始终随着一天中时间的推移自然下降到低水平。这就意味着原本相对集中的易于使用的共享单车分布会由于通勤等原因变得分散和难以使用。想要维持共享单车的合理分布及单车流动“借-还”循环畅通，就需要依赖基于通勤模式经验指导下的强制调度，这种调度一般发生在非通勤时间，共享单车服务公司使用卡车或平板三轮车搜集散乱在城市各处的共享单车并整齐放置到合理的地点以支撑第二天的骑行通勤需求。因此，由共享单车骑行轨迹数据中挖掘出的通勤模式具有一定的现实指导意义。

城市通勤数据反映了城市空间内中小尺度、周期性、密集型、高强度的人员流动情况。人们骑行共享单车属于一种缓慢的匀速移动，且具有较高的灵活性，其轨迹往往能够渗透到城市的每一条毛细血管般狭窄的道路中，相较于固定线路的通勤方式更能反映人的行为特性。结合以上两点，借助共享单车通勤轨迹数据，我们既可以从宏观上把握城市主要交通干线、主要产业热点区域一周七个工作日的人口规律性流动情况，分析总体城市职住分布与产业布局情况；我们也可以从城市的微观结构着手，探究渗入城市细小角落的骑行轨迹究竟反映了怎样的行为与细碎环境的相互作用。

综上所述，本研究旨在探究城市中共享单车通勤的时空模式，为城市规划和交通管理提供科学参考，同时为共享单车服务的优化提供建议。

## 1.2 国内外研究现状
（共享单车历史沿革段）
公共自行车系统（Bicycle-sharing system）最早可以追溯到1965年阿姆斯特丹城市街头的“白色自行车（White Bicycle Plan）”计划[1]，该计划将自行车刷成醒目的白色并免费提供给人们随意使用。由于缺乏有效的监管，多数自行车在很短的时间内遭到偷窃或蓄意破坏，致使该项目难以为继。后来，一些项目通过引入带有监控设备的停靠点并发放收取了一定押金的智能卡来约束使用者的行为，例如英国朴茨茅斯大学于1995年启动的“智能单车”项目等。然而，固定的停靠站点难以充分满足用户灵活的骑行需求，反而削减了自行车这一灵活交通工具的可达性优势[2]。随着移动互联网的发展及移动支付手段的普及，一种新兴的无桩公共自行车系统[3]取代了原先依赖停靠点的公共自行车系统。该系统使用电子围栏技术及移动端应用程序来规范用户用车行为，这种带有鲜明的互联网及共享经济时代特色最新一代公共自行车系统即人们熟知的“共享单车”系统。

（国内外研究现状）
共享单车出行数据蕴含丰富的时空信息，通过对这些数据的分析、整理及挖掘可以为城市治理及服务优化提供重要依据。采用合适的时空可视化手段可以有效发现隐藏在数据背后的规律。全雨霏[4]从宏观大数据角度，综合考虑骑行轨迹的起点、终点及起-终连结的时空特征，采用统计分析、问卷调查、实地调研等方法研究了南京市共享单车通勤模式，分析出共享单车使用时段的峰值规律、空间热点分布规律及其影响因素（绿地分布、公共交通换乘站点分布等）并结合此为城市规划提出自己的建议。Corcoran等人[5]基于澳大利亚布里斯班市的 "CityCycle" 公共自行车系统出行数据，采用多种可视化方法着重研究天气及日历事件（例如公共假期、周末、节假日等）对骑行时空模式的影响。共享单车出行数据中若存在明确的始末点位置记录，对其采用合适的空间可视化手段可以有效揭示用户骑行的O-D模式。Yang Xu等人[6]通过对新加坡主要无桩自行车共享运营商提供的四个月GPS数据进行特征分解分析，采用合适的时空可视化手段研究了不同地点的骑行活动时间波动模式，并将无桩自行车使用的时空模式关联到多个关键的建筑环境指标。杨永崇[7]等人基于城市骑行大数据，使用地理可视化手段研究城市骑行热点区域及用户出行OD模型。高楹[8]等人基于北京市摩拜单车运营数据，采用空间可视化手段研究该区域共享单车“源”、“汇”点的时空分布模式，并基于此提出一种局地优化的调度模型以优化共享单车小区域内的调度服务。

聚类分析可以有效识别具有相似模式的站点，这些站点可以进一步构建为网络以分析社区划分及流动模式等深层次内容。王若萱等人[9]使用随机森林模型，结合一套基于兴趣点数据的目的地区域建模指标体系重点分析了上海市区域性共享单车通勤模式，为后续该领域内的模拟仿真系统提供了研究基础。Jiménez 等人[10]基于用户出行行为模式数据，采用特定数据挖掘工具基于提出的三个指标（利用率、累计行程比率和周转站比率）对都柏林公共自行车共享系统的站点进行聚类分析。张芳[11]等人使用最邻近查找法将共享单车轨迹点聚类到最近的城市兴趣点上，以实现空间划分及骑行网络节点生成。刘冰等人[12]采用相似的研究思路，使用聚类及社区发现算法（鲁汶算法）研究基于共享单车的生活圈，他们发现骑行生活圈的空间范围相较于步行生活圈更大也更复杂，是居民日常通勤的基础性组成部分，合理地布置骑行网络对于便利居民生活具有重要意义。

回归分析可以有效探究用户行为与多种影响因素之间的关联。常新[13]对深圳市龙岗区时间跨度为半个月的共享单车轨迹数据进行回归分析，总结出骑行行为模式并反向推求城市环境对骑行行为的支撑作用，最后使用空间自相关理论分析原因，指出道路的繁忙程度对于骑行频次具有影响，并根据研究结果提出了合理的城市规划建议。谢国微[14]从天气与城市建成对骑行行为的影响出发，综合采用统计方法、地理加权回归模型(GWR)、核密度分析法、多元线性回归法等多种研究手段探究共享单车使用情况的时空模式及其影响因素。高枫[15]等人使用地理探测器研究广州市主城区共享单车时空分布模式及其影响因素。Shen等人[16]通过对新加坡无桩自行车共享服务的GPS数据进行收集和空间自回归模型分析，研究了自行车保有量、周边建筑环境、公共交通便利性、自行车基础设施和天气条件等因素对无桩式共享单车使用量的影响。

大量的真实出行数据可以有效支撑模拟仿真系统，基于这些数据也可以实现智能预测。随着数据驱动的智能算法逐步发展，也有一部分研究者注意到共享单车轨迹中蕴含的智能，他们使用新兴的数据驱动智能算法直接将数据本身转化为解决问题的能力，为交通预测、道路规划、大数据感知等应用场景提供助力。谢光明[17]为了解决共享单车时空供需不平衡问题，基于大量骑行轨迹数据研究出一套单车流量预测方法。他首先使用两级聚类及 K-means 算法基于密度找到虚拟站点，然后根据用户访问频次结合鲁汶(Louvain)算法得到虚拟站点间的社区网络最后使用图注意力网络(GAT)及LSTM网络并融合气象参数完成单车流量预测。该方法对于共享单车的动态调度，缓解单车分布时空不平衡具有重要的指导意义。Jie Bao 等人[18]基于上海市共享单车大数据记录开发出一套城市自行车道规划算法，该算法具有一个用于描述轨迹长度与收益关系的启发式函数，能够根据项目预算、施工周期等因素灵活调整自行车道设计结果，具有较高的工程实践价值。王俊等人[19]使用带有卷积层的长短期记忆网络（ConvLSTM），结合南京地区共享单车需求量，天气，季节等参数训练深度学习预测模型，对于需求量的预测精度相较于单一网络（卷积网络或长短期记忆网络）取得一定提升。

共享单车带来的环境效益也是许多学者研究的方向。李文翔等人[20]从环保的角度，使用问卷调查法、统计分析法及核密度分析法等方法结合减排因子计算公式评估了2016年上海市全年共享单车对于六种主要污染物的减排效益及空间分布模式，指出上海市人口密集区域具有更大的减排潜力。虽然共享单车是一种新兴互联网经济下发展起来的环境友好型便利交通设施具有诸多优势，共享单车市场快速膨胀也带来了许多城市治理难题，最为显著的问题之一就是大量损坏、报废共享单车的该如何处置。刘泉宏[21]等人重点考虑了共享单车生命周期末环的回收处理问题，基于武汉市共享单车报废点位采用先求取重心后进行 K-means 聚类的处理方法，计算出合理的共享单车回收站部署位置。该研究对于共享单车生命周期中后管理维护站点的选址提供了一定的技术支持。

上文提到的大多研究都是将共享单车轨迹视作一个整体，轨迹点视作点云，往往采用基于密度的空间聚类与统计方法，忽略了共享单车骑行轨迹作为矢量线段集合所内含的空间结构信息。任丹[22]使用 TRACLUS 算法船舶轨迹进行聚类，提取出公共航行轨迹，与一般的基于点密度聚类方式不同，该方法考虑到了轨迹数据本身作为向量的几何特征，对于共享单车骑行轨迹研究领域具有启发意义。

通过分析城市共享单车领域的国内外研究成果，本文作如下总结与思考：
（1）研究细分方向：大致可分为污染物与环境、城市道路规划、模拟仿真算法、社交网络分析、热点路段、时空模式分析及城市道路及空间规划质量评估等。可以发现，共享单车骑行轨迹中蕴含极其丰富的信息，是研究城市、自然、人及其关系的绝佳窗口。
（2）研究数据及方法：除用户骑行轨迹数据外，研究者也会根据研究的细分方向补充部分数据，包括居民出行问卷调查数据、城市基础地理数据（公交站台、绿地分布等）、天气数据、共享单车服务设施数据（报废处理站、虚拟停车桩等）以及其他类型的轨迹数据（包括步行、出租车等）。研究方法大致可分为统计法、聚类法（基于点、基于轨迹线）、地理统计法、及数据驱动的智能算法等。可以发现，共享单车轨迹数据具有丰富的时空结构信息，需要酌情选择合理的分析方法。
（3）思考：骑行轨迹数据往往与城市路网分布、主要基础设施分布以及生活设施分布具有一定的关联性，尤其需要考虑其与主要道路间的关联。骑行轨迹目的地暗含了用户的真实意愿，也可以根据目的地类别对轨迹进行分类，实现更进一步的分析。用户的行为特征及单车流动特征也可以成为重要的分析抓手，例如调查一段时间内某一用户的骑行频率，某段时间内单车的周转率等。共享单车通勤也会存在一定的早晚高峰及潮汐现象，寻找共享单车骑行量时间波动模式及共享单车潮汐区域空间分布模式具有重要意义。

## 1.3 研究内容与步骤（框图）
以往的研究大都以轨迹本身为研究重心，并以原因分析（考察天气等的影响）及副作用分析（考察减排效益等）为目的，并未充分考察骑行者的行为模式及轨迹与基础设施建的相互关系。因此，本文以上海市共享单车通勤用户为研究对象，以经预处理及清洗后的上海市共享单车骑行轨迹数据作为数据源，使用最邻近匹配算法、轨迹预处理算法（重排序、简化）、用户行为分析法、线密度算法、数学形态学操作、Jaccard相似系数、时空格网分析等研究方法，探究共享单车轨迹时空模式及其与通勤基础设施之间的关系。进一步的，本文为城市规划、共享单车管理等相关领域提出合理化的建议，以更好地促进上海市慢行交通系统的发展。本文的主要研究内容及研究步骤如下： 
（1）共享单车通勤数据数据建库：首先获取2016年8月及2020年8月上海市某品牌共享单车通勤数据（每条轨迹带有时间戳及起止点，其中2016年数据带有详细的骑行轨迹）；其次，进行数据预处理与清洗。针对2016年骑行轨迹数据，设计并实现轨迹重排序算法（3.2.2）、轨迹长度量测算法（3.2.2）及轨迹简化（抽稀）算法（3.2.3）。而后，针对轨迹长度、骑行时长、骑行速度、字段缺损状况等因素设计合理的数据清洗规则，剔除异常值；最后，计算每一段轨迹的起止点的GeoHash值，并将2016年骑行轨迹数据保存为便于存取的二进制格式（*.pickle），以便后续处理。
（2）上海市基础地理信息数据建库：首先从 Open Street Map 网站上下载上海市地理数据集（包含兴趣的、个级别路网等数据），并对数据进行裁剪及清洗；对于兴趣点数据，仅保留八类意义明确类型的数据；对于路网数据，仅提取主路、次主路及支路三个级别路网。然后，将兴趣的数据转化为 GeoHash 格式，并构建树状空间索引，以便快速查找最邻近的兴趣点；最后将空间索引及数据集保存为为易于存取的二进制格式。
（3）共享单车通勤时间模式分析：借助预先建立的通勤数据库，从时间角度探究骑行通勤模式，分别从轨迹时距分布模式、单车日周转趋势，用户骑行时间间隔模式角度对用户骑行通勤模式进行分析，并探究背后的可能原因，总结相关规律。
（4）共享单车通勤空间模式分析：综合通勤数据库及上海市兴趣点数据库，从空间角度考察轨迹的空间分布模式。首先使用轨迹终点最近邻匹配算法（3.3.1）为每一段轨迹终点匹配最邻近兴趣点，并据此分析轨迹终点的类型占比及空间分布模式。然后使用线密度栅格来具体分析通勤轨迹空间分布模式及其与路网间的相似关系。最后根据潮汐指数来考察共享单车潮汐区域空间分布，并总结相关规律。

## 1.4 论文组织结构
本文共分为五章：
第一章为绪论。主要从宏观角度论述本文的研究背景及研究意义，并对国内外共享单车轨迹分析、城市通勤分析等领域的研究成果进行总结概括为国内外研究现状，参考国内外研究现状确定本文研究内容及技术路线，为后续研究明确方向，打下基础。
第二章介绍理论基础与相关技术。该部分首先从学术理论入手，介绍了行为地理学、城市职住平衡与过剩通勤理论，进一步明确所研究问题的理论本质。然后从研究技术着手，介绍了相似性分析、密度分析、用户行为分析等领域内常用的技术手段。
第三章介绍本研究用到的数据及开展研究时所用到的具体方法。首先介绍数据来源及数据细节，并介绍数据清洗规则,而后结合数据特征，介绍轨迹点重排序、轨迹长度量测、轨迹抽稀、数学形态学操作及Jaccard相似系数等数据处理分析算法。

第四章着重介绍本文的研究结论。从时、空两个方向，结合轨迹时距分布特征、目的地分布特征、综合使用线密度计算、数学形态学操作等方法，得出骑行热点时段分布、骑行热点路段分布、各级别道路对骑行通勤支撑情况及骑行潮汐区域分布情况。
第五章为总结与展望，结合本文研究内容提出概括性结论，针对研究过程提出不足与未来进一步完善的方向。同时，结合得到的上海市骑行通勤时空分布特征，为相关企业及有关部门建言献策。

## 1.5 本章小结
本章首先介绍本文的研究背景及意义，指出研究共享单车通勤模式对于理解及优化以共享单车为代表的城市慢行交通系统具有重要意义。而后，本文考察了国内外研究现状，提出相关总结与思考，并进一步介绍本文的主要研究内容与步骤框架。最后，该章节对本文组织结果做出简要介绍。